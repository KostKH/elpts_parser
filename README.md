# elpts_parser
Скрипт преобразует табличные данные о птс, которые доступны для всех пользователей на портале электронных птс в формат, удобный для сохранения в excel-файле. В результате работы скрипта данные с портала сохраняются в excel-файл.

## Системные требования
- Python 3.11+
- Работает на Linux, Windows
- Дополнительное требование для Windows - установка Git Bash. (Активировать виртуальное окружение и запускать скрипт нужно будет из данного терминала)

## Технологии:
- Python 3.11
- aiohttp 3.8.3
- openpyxl 3.0.10

## Как запустить скрипт:

Необходимо выполнить следующие шаги:
- Установить на компьютер Python 3.11. (С более старыми версиями Python скрипт не тестировался)

- Для Windows - запустить терминал Git Bash.

- Клонировать данный репозиторий к себе на компьютер и перейти в папку с кодом из репозитория.
Альтернативный вариант - просто скачать из данного репозитория и распаковать в папку архив кода.

```
Клонирование репозитория:
git clone https://github.com/KostKH/elpts_parser.git
cd elpts_parser/
```

- Находясь в папке с кодом из репозитория, создать и активировать виртуальное окружение:
```
Команды для Windows (запускаются из Git Bash):
python -m venv venv
source venv/scripts/activate

Команды для Linux:
python3 -m venv venv
source venv/bin/activate
```

- Установить зависимости, необходимые для работы скрипта:
```
pip install -r requirements.txt
```

- Запустить скрипт:
```
Команда для Windows (запускается из Git Bash):
python elpts_parser.py

Команда для Linux:
python3 elpts_parser.py
```

## Особенности работы скрипта:
Скрипт создаст папку results, после этого создаст в этой папке файл elpts.xlsx и сохранит на лист "elpts" результаты работы. Если файл elpts.xlsx уже существует в папке results - в начале работы скрипта в нём будет удален старый лист с именем "elpts" и вместо него будет создан новый лист с таким же именем. То есть старые результаты парсинга будут удалены.

Работа скрипта логируется и сохраняется в файл elpts.log 

Имена файлов и папки можно изменить - для этого нужно отредактировать файл settings.py

## О программе:

Лицензия: BSD 3-Clause License

Автор: Константин Харьков